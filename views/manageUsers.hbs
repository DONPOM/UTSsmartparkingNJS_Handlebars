<div class="contentContainer">

<h1>Manage Users</h1>
<p>Welcome to User management</p>

<section>
    <h2>Add User</h2>
    <form action="/addUser" method="post">
        UserID <input type="text" id="userID" class="form-control" name="userID">
        Name<input type="text" id="name" name="name">
        Phone<input type="text" id="phone" name="phone">
        Email<input type="text" id="email" name="email">
        User Type<input type="text" id="usertype" name="usertype">
        Password<input type="text" id="password" name="password">
        <button type="submit">INSERT</button>
    </form>

</section>

<section>
    <h2>Delete User</h2>
    <form action="/deleteUser" method="delete">
        UserID <input type="text" id="userID" name="userID">
    </form>
    <button type="submit">DELETEEE</button>
</section>

<section class="users">
    <h2>Current Users</h2>

    <table style="width:100%">
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Phone Number</th>
            <th>Email</th>
            <th>User Type</th>
            <th>Options</th>
        </tr>
        {{# each users}}
            <tr>
                <td> {{ this.userID }} </td>
                <td> {{ this.name }} </td>
                <td> {{ this.phone }} </td>
                <td> {{ this.email }} </td>
                <td> {{ this.userType }} </td>
                <td>
                    <button class="btn btn-primary viewUser" id="{{this.userID}}">View</button>
                    <button class="btn btn-danger deleteUser" id="{{this.userID}}" data-toggle="modal"
                            data-target="#deleteUserModal">Delete</button>
                </td>
            </tr>
        {{/each }}
    </table>
    </div>
</section>



<div class="modal fade" id="deleteUserModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Delete User</h3>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this User?<br>This action cannot be
                    undone.</p>
            </div>
            <div class="modal-footer">
                <form method="post" action="deleteUser">
                    <input name="deleteUserID" type="hidden" value="">
                    <button type="button" class="btn btn-dark" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-danger" >Permanently Delete User</button>
                </form>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="userDetailsModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">User Details</h3>
            </div>
            <div class="modal-body">
                <p>
                <div id="userDetails">
                <h4>Details</h4>
                <table>
                    <tr>
                        <th>Name:</th>
                        <td><span id="userName"></span></td>
                    </tr>
                    <tr>
                        <th>ID:</th>
                        <td><span id="userIDModal"></span></td>
                    </tr>
                    <tr>
                        <th>Phone:</th>
                        <td><span id="userPhone"></span></td>
                    </tr>
                    <tr>
                        <th>Email:</th>
                        <td><span id="userEmail"></span></td>
                    </tr>
                    <tr>
                        <th>User Type:</th>
                        <td><span id="userType"></span></td>
                    </tr>
                </table>
                </div>
                <div id="userBookings">
                    <h4>User Bookings</h4>
                </div>
                </p>
            </div>
            <div class="modal-footer">

                <input type="hidden" value="{{user.userID}}">
                <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>

            </div>
        </div>
    </div>
</div>
</div>

<script>

    $(document).ready(function () {
        $('.viewUser').click(function () {
            var userID = $(this).attr("id");
            $.ajax({
                url: "/getUserData",
                method: "post",
                data: {userID: userID},
                success: function (data) {
                    //$('#userDetails').html(data);
                    $('#userName').html(data.user.name);
                    $('#userIDModal').html(data.user.userID);
                    $('#userPhone').html(data.user.phone);
                    $('#userEmail').html(data.user.email);
                    $('#userType').html(data.user.userType);
                    $('#userDetailsModal').modal("show");
                }
            });
        });
        $('.deleteUser').click(function () {
            var userID = $(this).attr("id");
            $("[name='deleteUserID']").val(userID);
        });
    });

</script>
